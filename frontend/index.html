<!doctype html>
<html lang="ja" class="scroll-smooth">
  <head>
    <meta charset="UTF-8" />
    <link rel="icon" type="image/svg+xml" href="/vite.svg" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta name="description" content="gWiki - A federated wiki application powered by Google Apps Script" />
    <title>gWiki - Federated Wiki</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="/src/index.css">
  </head>
  <body class="bg-gray-50 text-gray-900 dark:bg-gray-900 dark:text-gray-100">
    <div id="app" x-data="wikiApp()" x-init="init()" class="min-h-screen">
      <!-- Header -->
      <header class="bg-white dark:bg-gray-800 shadow-sm border-b border-gray-200 dark:border-gray-700">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
          <div class="flex justify-between items-center h-16">
            <a href="#/" @click.prevent="navigate('')" class="flex items-center space-x-2">
              <span class="text-xl font-bold text-purple-600 dark:text-purple-400">gWiki</span>
            </a>
            <nav class="flex items-center space-x-4">
              <button @click="$store.theme.toggle()" class="p-2 rounded-lg hover:bg-gray-100 dark:hover:bg-gray-700" aria-label="Toggle theme">
                <span x-show="$store.theme.dark">üåô</span>
                <span x-show="!$store.theme.dark">‚òÄÔ∏è</span>
              </button>
              <a href="#/admin/peers" @click.prevent="navigate('admin/peers')" class="text-sm text-gray-600 dark:text-gray-300 hover:text-purple-600">Peers</a>
              <a href="#/admin/external-index" @click.prevent="navigate('admin/external-index')" class="text-sm text-gray-600 dark:text-gray-300 hover:text-purple-600">External Index</a>
              <a href="#/admin/stats" @click.prevent="navigate('admin/stats')" class="text-sm text-gray-600 dark:text-gray-300 hover:text-purple-600">Stats</a>
            </nav>
          </div>
        </div>
      </header>

      <!-- Main Content -->
      <main class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8">
        <!-- Home Page -->
        <template x-if="route === ''">
          <div x-data="homePage()">
            <template x-if="loading">
              <div class="flex items-center justify-center py-12">
                <div class="text-center">
                  <div class="w-16 h-16 border-4 border-purple-200 border-t-purple-600 rounded-full animate-spin mx-auto mb-4"></div>
                  <p class="text-gray-600 dark:text-gray-400">Loading pages...</p>
                </div>
              </div>
            </template>

            <template x-if="error">
              <div class="flex items-center justify-center py-12">
                <div class="bg-white dark:bg-gray-800 rounded-lg shadow-lg p-8 max-w-md text-center">
                  <p class="text-red-600 text-xl mb-4">‚ùå <span x-text="error"></span></p>
                  <button @click="init()" class="px-6 py-2 bg-purple-600 text-white rounded-lg hover:bg-purple-700">
                    Retry
                  </button>
                </div>
              </div>
            </template>

            <template x-if="!loading && !error">
              <div>
                <div class="mb-8 text-center">
                  <h1 class="text-4xl font-bold text-gray-900 dark:text-gray-100 mb-2">
                    Welcome to <span class="text-purple-600">gWiki</span>
                  </h1>
                  <p class="text-lg text-gray-600 dark:text-gray-400">
                    A federated wiki powered by Google Apps Script
                  </p>
                </div>

                <template x-if="pages.length === 0">
                  <div class="bg-white dark:bg-gray-800 rounded-lg shadow-lg p-8 max-w-2xl mx-auto text-center">
                    <div class="text-6xl mb-4">üìù</div>
                    <h2 class="text-2xl font-bold text-gray-800 dark:text-gray-200 mb-2">
                      No pages yet
                    </h2>
                    <p class="text-gray-600 dark:text-gray-400 mb-6">
                      Get started by creating your first wiki page!
                    </p>
                    <a href="#/new" @click.prevent="navigate('new')" class="inline-block px-6 py-3 bg-purple-600 text-white rounded-lg hover:bg-purple-700">
                      ‚ú® Create New Page
                    </a>
                  </div>
                </template>

                <template x-if="pages.length > 0">
                  <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
                    <template x-for="page in pages" :key="page.id">
                      <a :href="'#/page/' + page.id" @click.prevent="navigate('page/' + page.id)" class="block bg-white dark:bg-gray-800 rounded-lg shadow-md hover:shadow-lg transition-shadow p-6">
                        <h3 class="text-xl font-semibold text-gray-900 dark:text-gray-100 mb-2" x-text="page.title"></h3>
                        <p class="text-gray-600 dark:text-gray-400 text-sm mb-4" x-text="page.content.substring(0, 100) + '...'"></p>
                        <div class="flex items-center justify-between text-sm text-gray-500 dark:text-gray-500">
                          <span x-text="formatDate(page.updatedAt)"></span>
                          <template x-if="page.tags && page.tags.length > 0">
                            <div class="flex gap-1">
                              <template x-for="tag in page.tags.slice(0, 3)" :key="tag">
                                <span class="px-2 py-1 bg-purple-100 dark:bg-purple-900 text-purple-700 dark:text-purple-300 rounded text-xs" x-text="tag"></span>
                              </template>
                            </div>
                          </template>
                        </div>
                      </a>
                    </template>
                  </div>
                </template>
              </div>
            </template>
          </div>
        </template>

        <!-- Page View -->
        <template x-if="route.startsWith('page/')">
          <div x-data="pageView(route.split('/')[1])">
            <template x-if="loading">
              <div class="flex items-center justify-center py-12">
                <div class="text-center">
                  <div class="w-16 h-16 border-4 border-purple-200 border-t-purple-600 rounded-full animate-spin mx-auto mb-4"></div>
                  <p class="text-gray-600 dark:text-gray-400">Loading page...</p>
                </div>
              </div>
            </template>

            <template x-if="error">
              <div class="flex items-center justify-center py-12">
                <div class="bg-white dark:bg-gray-800 rounded-lg shadow-lg p-8 max-w-md text-center">
                  <p class="text-red-600 text-xl mb-4">‚ùå <span x-text="error"></span></p>
                  <a href="#/" @click.prevent="navigate('')" class="inline-block px-6 py-2 bg-purple-600 text-white rounded-lg hover:bg-purple-700">
                    ‚Üê Back to Home
                  </a>
                </div>
              </div>
            </template>

            <template x-if="!loading && !error && page">
              <div class="max-w-4xl mx-auto">
                <!-- Actions -->
                <div class="mb-6 flex items-center justify-between">
                  <a href="#/" @click.prevent="navigate('')" class="px-4 py-2 text-gray-600 dark:text-gray-400 hover:text-purple-600 dark:hover:text-purple-400">
                    ‚Üê Back
                  </a>
                  <div class="flex items-center space-x-3">
                    <a :href="'#/edit/' + page.id" @click.prevent="navigate('edit/' + page.id)" class="px-4 py-2 bg-gray-200 dark:bg-gray-700 text-gray-700 dark:text-gray-300 rounded-lg hover:bg-gray-300 dark:hover:bg-gray-600">
                      ‚úèÔ∏è Edit
                    </a>
                    <button @click="deletePage()" class="px-4 py-2 bg-red-500 text-white rounded-lg hover:bg-red-600">
                      üóëÔ∏è Delete
                    </button>
                  </div>
                </div>

                <!-- Page Content -->
                <div class="bg-white dark:bg-gray-800 rounded-lg shadow-lg p-8">
                  <h1 class="text-4xl font-bold text-gray-900 dark:text-gray-100 mb-4" x-text="page.title"></h1>

                  <div class="flex items-center space-x-6 text-sm text-gray-500 dark:text-gray-400 mb-4">
                    <span class="flex items-center space-x-1">
                      <span>üìÖ</span>
                      <span>‰ΩúÊàê: <span x-text="formatDate(page.createdAt)"></span></span>
                    </span>
                    <template x-if="page.updatedAt !== page.createdAt">
                      <span class="flex items-center space-x-1">
                        <span>‚úèÔ∏è</span>
                        <span>Êõ¥Êñ∞: <span x-text="formatDate(page.updatedAt)"></span></span>
                      </span>
                    </template>
                  </div>

                  <template x-if="page.tags && page.tags.length > 0">
                    <div class="flex flex-wrap gap-2 mb-6">
                      <template x-for="tag in page.tags" :key="tag">
                        <span class="px-3 py-1 text-sm font-semibold rounded-full bg-purple-100 dark:bg-purple-900/30 text-purple-600 dark:text-purple-300" x-text="'#' + tag"></span>
                      </template>
                    </div>
                  </template>

                  <div class="prose dark:prose-invert max-w-none">
                    <div x-html="await renderContent(page.content)"></div>
                  </div>
                </div>

                <!-- Version History -->
                <div class="mt-6 bg-white dark:bg-gray-800 rounded-lg shadow-lg p-6">
                  <button @click="toggleVersions()" class="flex items-center justify-between w-full text-left">
                    <h2 class="text-xl font-bold text-gray-900 dark:text-gray-100">üìú Version History</h2>
                    <span :class="showingVersions ? 'rotate-180' : ''" class="transition-transform">‚ñº</span>
                  </button>

                  <div x-show="showingVersions" x-transition class="mt-4 space-y-3">
                    <template x-if="versions.length === 0">
                      <p class="text-gray-500 dark:text-gray-400">No version history available.</p>
                    </template>
                    <template x-for="(version, index) in versions" :key="version.id">
                      <div class="p-3 bg-gray-50 dark:bg-gray-700 rounded-lg">
                        <div class="flex items-center justify-between">
                          <div>
                            <span class="font-semibold text-gray-900 dark:text-gray-100" x-text="version.title"></span>
                            <span class="text-sm text-gray-500 dark:text-gray-400 ml-2" x-text="formatDate(version.updatedAt)"></span>
                          </div>
                          <span class="text-xs text-gray-400" x-text="'v' + (versions.length - index)"></span>
                        </div>
                      </div>
                    </template>
                  </div>
                </div>
              </div>
            </template>
          </div>
        </template>

        <!-- Page Editor -->
        <template x-if="route.startsWith('edit/')">
          <div x-data="pageEditor(route.split('/')[1])" :key="route.split('/')[1]">
            <template x-if="loading">
              <div class="flex items-center justify-center py-12">
                <div class="text-center">
                  <div class="w-16 h-16 border-4 border-purple-200 border-t-purple-600 rounded-full animate-spin mx-auto mb-4"></div>
                  <p class="text-gray-600 dark:text-gray-400">Loading editor...</p>
                </div>
              </div>
            </template>

            <template x-if="!loading">
              <div class="max-w-6xl mx-auto">
                <!-- Header -->
                <div class="mb-6 flex items-center justify-between">
                  <h1 class="text-3xl font-bold text-gray-900 dark:text-gray-100">
                    <span x-text="isEditMode ? '‚úèÔ∏è Edit Page' : '‚ú® New Page'"></span>
                  </h1>
                  <div class="flex items-center space-x-3">
                    <button @click="showPreview = !showPreview" class="px-4 py-2 bg-gray-200 dark:bg-gray-700 text-gray-700 dark:text-gray-300 rounded-lg hover:bg-gray-300 dark:hover:bg-gray-600">
                      <span x-text="showPreview ? 'üìù Edit' : 'üëÅÔ∏è Preview'"></span>
                    </button>
                    <button @click="cancel()" class="px-4 py-2 bg-gray-200 dark:bg-gray-700 text-gray-700 dark:text-gray-300 rounded-lg hover:bg-gray-300 dark:hover:bg-gray-600">
                      Cancel
                    </button>
                    <button @click="save()" :disabled="saving" class="px-4 py-2 bg-purple-600 text-white rounded-lg hover:bg-purple-700 disabled:opacity-50">
                      <span x-text="saving ? 'üíæ Saving...' : 'üíæ Save'"></span>
                    </button>
                  </div>
                </div>

                <!-- Error -->
                <template x-if="error">
                  <div class="mb-4 p-4 bg-red-100 dark:bg-red-900/30 border border-red-300 dark:border-red-700 text-red-700 dark:text-red-300 rounded-lg">
                    <span x-text="error"></span>
                  </div>
                </template>

                <!-- Editor Card -->
                <div class="bg-white dark:bg-gray-800 rounded-lg shadow-lg p-8">
                  <template x-if="!showPreview">
                    <div class="space-y-6">
                      <!-- Title -->
                      <div>
                        <label for="title" class="block text-sm font-semibold text-gray-700 dark:text-gray-300 mb-2">
                          Title
                        </label>
                        <input
                          id="title"
                          type="text"
                          x-model="title"
                          placeholder="Enter page title..."
                          class="w-full px-4 py-3 rounded-lg border border-gray-300 dark:border-gray-700 focus:border-purple-500 focus:ring-2 focus:ring-purple-200 dark:focus:ring-purple-800 outline-none transition-all duration-300 text-lg font-semibold bg-white dark:bg-gray-900 text-gray-900 dark:text-gray-100"
                        />
                      </div>

                      <!-- Tags -->
                      <div>
                        <label for="tags" class="block text-sm font-semibold text-gray-700 dark:text-gray-300 mb-2">
                          Tags (comma separated)
                        </label>
                        <input
                          id="tags"
                          type="text"
                          x-model="tags"
                          placeholder="e.g. guide, tutorial, important"
                          class="w-full px-4 py-2 rounded-lg border border-gray-300 dark:border-gray-700 focus:border-purple-500 focus:ring-2 focus:ring-purple-200 dark:focus:ring-purple-800 outline-none transition-all duration-300 bg-white dark:bg-gray-900 text-gray-900 dark:text-gray-100"
                        />
                      </div>

                      <!-- Content -->
                      <div>
                        <label for="content" class="block text-sm font-semibold text-gray-700 dark:text-gray-300 mb-2">
                          Content (Markdown)
                        </label>
                        <textarea
                          id="content"
                          x-model="content"
                          placeholder="Enter page content in Markdown format..."
                          rows="20"
                          class="w-full px-4 py-3 rounded-lg border border-gray-300 dark:border-gray-700 focus:border-purple-500 focus:ring-2 focus:ring-purple-200 dark:focus:ring-purple-800 outline-none transition-all duration-300 font-mono text-sm resize-y bg-white dark:bg-gray-900 text-gray-900 dark:text-gray-100"
                        ></textarea>
                      </div>

                      <!-- Tip -->
                      <div class="bg-blue-50 dark:bg-blue-900/20 border border-blue-200 dark:border-blue-800 rounded-lg p-4">
                        <p class="text-sm text-blue-800 dark:text-blue-300">
                          <strong>üí° Tip:</strong> You can use Markdown syntax for formatting.
                          Click the Preview button to see how your content will look.
                        </p>
                      </div>
                    </div>
                  </template>

                  <!-- Preview -->
                  <template x-if="showPreview">
                    <div>
                      <h2 class="text-3xl font-bold text-gray-900 dark:text-gray-100 mb-6 pb-4 border-b border-gray-200 dark:border-gray-700">
                        <span x-text="title || 'Untitled Page'"></span>
                      </h2>
                      <div class="prose dark:prose-invert max-w-none">
                        <div x-html="await renderContent(content || '*No content yet*')"></div>
                      </div>
                    </div>
                  </template>
                </div>
              </div>
            </template>
          </div>
        </template>

        <!-- New Page -->
        <template x-if="route === 'new'">
          <div x-data="pageEditor()">
            <template x-if="loading">
              <div class="flex items-center justify-center py-12">
                <div class="text-center">
                  <div class="w-16 h-16 border-4 border-purple-200 border-t-purple-600 rounded-full animate-spin mx-auto mb-4"></div>
                  <p class="text-gray-600 dark:text-gray-400">Loading editor...</p>
                </div>
              </div>
            </template>

            <template x-if="!loading">
              <div class="max-w-6xl mx-auto">
                <!-- Header -->
                <div class="mb-6 flex items-center justify-between">
                  <h1 class="text-3xl font-bold text-gray-900 dark:text-gray-100">
                    <span x-text="isEditMode ? '‚úèÔ∏è Edit Page' : '‚ú® New Page'"></span>
                  </h1>
                  <div class="flex items-center space-x-3">
                    <button @click="showPreview = !showPreview" class="px-4 py-2 bg-gray-200 dark:bg-gray-700 text-gray-700 dark:text-gray-300 rounded-lg hover:bg-gray-300 dark:hover:bg-gray-600">
                      <span x-text="showPreview ? 'üìù Edit' : 'üëÅÔ∏è Preview'"></span>
                    </button>
                    <button @click="cancel()" class="px-4 py-2 bg-gray-200 dark:bg-gray-700 text-gray-700 dark:text-gray-300 rounded-lg hover:bg-gray-300 dark:hover:bg-gray-600">
                      Cancel
                    </button>
                    <button @click="save()" :disabled="saving" class="px-4 py-2 bg-purple-600 text-white rounded-lg hover:bg-purple-700 disabled:opacity-50">
                      <span x-text="saving ? 'üíæ Saving...' : 'üíæ Save'"></span>
                    </button>
                  </div>
                </div>

                <!-- Error -->
                <template x-if="error">
                  <div class="mb-4 p-4 bg-red-100 dark:bg-red-900/30 border border-red-300 dark:border-red-700 text-red-700 dark:text-red-300 rounded-lg">
                    <span x-text="error"></span>
                  </div>
                </template>

                <!-- Editor Card -->
                <div class="bg-white dark:bg-gray-800 rounded-lg shadow-lg p-8">
                  <template x-if="!showPreview">
                    <div class="space-y-6">
                      <!-- Title -->
                      <div>
                        <label for="title-new" class="block text-sm font-semibold text-gray-700 dark:text-gray-300 mb-2">
                          Title
                        </label>
                        <input
                          id="title-new"
                          type="text"
                          x-model="title"
                          placeholder="Enter page title..."
                          class="w-full px-4 py-3 rounded-lg border border-gray-300 dark:border-gray-700 focus:border-purple-500 focus:ring-2 focus:ring-purple-200 dark:focus:ring-purple-800 outline-none transition-all duration-300 text-lg font-semibold bg-white dark:bg-gray-900 text-gray-900 dark:text-gray-100"
                        />
                      </div>

                      <!-- Tags -->
                      <div>
                        <label for="tags-new" class="block text-sm font-semibold text-gray-700 dark:text-gray-300 mb-2">
                          Tags (comma separated)
                        </label>
                        <input
                          id="tags-new"
                          type="text"
                          x-model="tags"
                          placeholder="e.g. guide, tutorial, important"
                          class="w-full px-4 py-2 rounded-lg border border-gray-300 dark:border-gray-700 focus:border-purple-500 focus:ring-2 focus:ring-purple-200 dark:focus:ring-purple-800 outline-none transition-all duration-300 bg-white dark:bg-gray-900 text-gray-900 dark:text-gray-100"
                        />
                      </div>

                      <!-- Content -->
                      <div>
                        <label for="content-new" class="block text-sm font-semibold text-gray-700 dark:text-gray-300 mb-2">
                          Content (Markdown)
                        </label>
                        <textarea
                          id="content-new"
                          x-model="content"
                          placeholder="Enter page content in Markdown format..."
                          rows="20"
                          class="w-full px-4 py-3 rounded-lg border border-gray-300 dark:border-gray-700 focus:border-purple-500 focus:ring-2 focus:ring-purple-200 dark:focus:ring-purple-800 outline-none transition-all duration-300 font-mono text-sm resize-y bg-white dark:bg-gray-900 text-gray-900 dark:text-gray-100"
                        ></textarea>
                      </div>

                      <!-- Tip -->
                      <div class="bg-blue-50 dark:bg-blue-900/20 border border-blue-200 dark:border-blue-800 rounded-lg p-4">
                        <p class="text-sm text-blue-800 dark:text-blue-300">
                          <strong>üí° Tip:</strong> You can use Markdown syntax for formatting.
                          Click the Preview button to see how your content will look.
                        </p>
                      </div>
                    </div>
                  </template>

                  <!-- Preview -->
                  <template x-if="showPreview">
                    <div>
                      <h2 class="text-3xl font-bold text-gray-900 dark:text-gray-100 mb-6 pb-4 border-b border-gray-200 dark:border-gray-700">
                        <span x-text="title || 'Untitled Page'"></span>
                      </h2>
                      <div class="prose dark:prose-invert max-w-none">
                        <div x-html="await renderContent(content || '*No content yet*')"></div>
                      </div>
                    </div>
                  </template>
                </div>
              </div>
            </template>
          </div>
        </template>

        <!-- Broken Links Admin -->
        <template x-if="route === 'admin/broken-links'">
          <div x-data="brokenLinksAdmin()">
            <template x-if="loading">
              <div class="flex items-center justify-center py-12">
                <div class="text-center">
                  <div class="w-16 h-16 border-4 border-purple-200 border-t-purple-600 rounded-full animate-spin mx-auto mb-4"></div>
                  <p class="text-gray-600 dark:text-gray-400">„É™„É≥„ÇØÂàá„Çå„ÇíÊ§úÁ¥¢‰∏≠...</p>
                </div>
              </div>
            </template>

            <template x-if="!loading">
              <div class="max-w-4xl mx-auto">
                <div class="mb-6">
                  <a href="#/" @click.prevent="navigate('')" class="inline-block px-4 py-2 text-gray-600 dark:text-gray-400 hover:text-purple-600 dark:hover:text-purple-400 mb-4">
                    ‚Üê „Éõ„Éº„É†„Å´Êàª„Çã
                  </a>
                  <h1 class="text-4xl font-bold text-gray-900 dark:text-gray-100 mb-2">üîó „É™„É≥„ÇØÂàá„Çå</h1>
                  <p class="text-gray-600 dark:text-gray-400">
                    Â≠òÂú®„Åó„Å™„ÅÑ„Éö„Éº„Ç∏„Å∏„ÅÆ„É™„É≥„ÇØ„ÅÆ‰∏ÄË¶ß„Åß„Åô
                  </p>
                </div>

                <template x-if="brokenLinks.length === 0">
                  <div class="bg-white dark:bg-gray-800 rounded-lg shadow-lg p-8 text-center">
                    <div class="text-6xl mb-4">‚úÖ</div>
                    <h2 class="text-2xl font-bold text-gray-800 dark:text-gray-200 mb-2">
                      „É™„É≥„ÇØÂàá„Çå„ÅØ„ÅÇ„Çä„Åæ„Åõ„Çì
                    </h2>
                    <p class="text-gray-600 dark:text-gray-400">
                      „Åô„Åπ„Å¶„ÅÆWiki„É™„É≥„ÇØ„ÅåÊ≠£Â∏∏„Åß„Åô!
                    </p>
                  </div>
                </template>

                <template x-if="brokenLinks.length > 0">
                  <div class="bg-white dark:bg-gray-800 rounded-lg shadow-lg p-6">
                    <div class="mb-4 text-gray-600 dark:text-gray-400">
                      <span x-text="brokenLinks.length"></span>‰ª∂„ÅÆ„É™„É≥„ÇØÂàá„Çå„ÅåË¶ã„Å§„Åã„Çä„Åæ„Åó„Åü
                    </div>
                    <div class="space-y-4">
                      <template x-for="(item, index) in brokenLinks" :key="index">
                        <div class="p-4 rounded-lg bg-red-50 dark:bg-red-900/20 border border-red-200 dark:border-red-800">
                          <div class="flex items-start justify-between">
                            <div class="flex-1">
                              <div class="text-sm text-gray-600 dark:text-gray-400 mb-1">
                                „É™„É≥„ÇØÂÖÉ:
                              </div>
                              <a :href="'#/page/' + item.page.id" @click.prevent="navigate('page/' + item.page.id)" class="text-lg font-semibold text-purple-600 dark:text-purple-400 hover:underline" x-text="item.page.title"></a>
                              <div class="mt-2 text-sm text-gray-600 dark:text-gray-400">
                                Â≠òÂú®„Åó„Å™„ÅÑ„Éö„Éº„Ç∏: <span class="font-mono text-red-600 dark:text-red-400">[<span x-text="item.brokenLinks[0]"></span>]</span>
                              </div>
                            </div>
                            <a :href="'#/new?title=' + encodeURIComponent(item.brokenLinks[0])" @click.prevent="navigate('new')" class="ml-4 px-3 py-1 bg-purple-600 text-white rounded-lg hover:bg-purple-700 text-sm">
                              „Éö„Éº„Ç∏„Çí‰ΩúÊàê
                            </a>
                          </div>
                        </div>
                      </template>
                    </div>
                  </div>
                </template>
              </div>
            </template>
          </div>
        </template>

        <!-- Orphaned Pages Admin -->
        <template x-if="route === 'admin/orphaned-pages'">
          <div x-data="orphanedPagesAdmin()">
            <template x-if="loading">
              <div class="flex items-center justify-center py-12">
                <div class="text-center">
                  <div class="w-16 h-16 border-4 border-purple-200 border-t-purple-600 rounded-full animate-spin mx-auto mb-4"></div>
                  <p class="text-gray-600 dark:text-gray-400">Â≠§Á´ã„Åó„Åü„Éö„Éº„Ç∏„ÇíÊ§úÁ¥¢‰∏≠...</p>
                </div>
              </div>
            </template>

            <template x-if="!loading">
              <div class="max-w-4xl mx-auto">
                <div class="mb-6">
                  <a href="#/" @click.prevent="navigate('')" class="inline-block px-4 py-2 text-gray-600 dark:text-gray-400 hover:text-purple-600 dark:hover:text-purple-400 mb-4">
                    ‚Üê „Éõ„Éº„É†„Å´Êàª„Çã
                  </a>
                  <h1 class="text-4xl font-bold text-gray-900 dark:text-gray-100 mb-2">üèùÔ∏è Â≠§Á´ã„Åó„Åü„Éö„Éº„Ç∏</h1>
                  <p class="text-gray-600 dark:text-gray-400">
                    ‰ªñ„ÅÆ„Éö„Éº„Ç∏„Åã„Çâ„É™„É≥„ÇØ„Åï„Çå„Å¶„ÅÑ„Å™„ÅÑ„Éö„Éº„Ç∏„ÅÆ‰∏ÄË¶ß„Åß„Åô
                  </p>
                </div>

                <template x-if="orphanedPages.length === 0">
                  <div class="bg-white dark:bg-gray-800 rounded-lg shadow-lg p-8 text-center">
                    <div class="text-6xl mb-4">üéâ</div>
                    <h2 class="text-2xl font-bold text-gray-800 dark:text-gray-200 mb-2">
                      Â≠§Á´ã„Åó„Åü„Éö„Éº„Ç∏„ÅØ„ÅÇ„Çä„Åæ„Åõ„Çì
                    </h2>
                    <p class="text-gray-600 dark:text-gray-400">
                      „Åô„Åπ„Å¶„ÅÆ„Éö„Éº„Ç∏„ÅåÈÅ©Âàá„Å´„É™„É≥„ÇØ„Åï„Çå„Å¶„ÅÑ„Åæ„Åô!
                    </p>
                  </div>
                </template>

                <template x-if="orphanedPages.length > 0">
                  <div class="bg-white dark:bg-gray-800 rounded-lg shadow-lg p-6">
                    <div class="mb-4 text-gray-600 dark:text-gray-400">
                      <span x-text="orphanedPages.length"></span>‰ª∂„ÅÆÂ≠§Á´ã„Åó„Åü„Éö„Éº„Ç∏„ÅåË¶ã„Å§„Åã„Çä„Åæ„Åó„Åü
                    </div>
                    <div class="space-y-3">
                      <template x-for="page in orphanedPages" :key="page.id">
                        <a :href="'#/page/' + page.id" @click.prevent="navigate('page/' + page.id)" class="block p-4 rounded-lg bg-gray-50 dark:bg-gray-700 hover:bg-gray-100 dark:hover:bg-gray-600 transition-colors">
                          <div class="font-semibold text-purple-600 dark:text-purple-400" x-text="page.title"></div>
                          <div class="text-sm text-gray-500 dark:text-gray-400 mt-1" x-text="formatDate(page.updatedAt)"></div>
                        </a>
                      </template>
                    </div>
                  </div>
                </template>
              </div>
            </template>
          </div>
        </template>

        <!-- Stats Admin -->
        <template x-if="route === 'admin/stats'">
          <div x-data="statsAdmin()">
            <template x-if="loading">
              <div class="flex items-center justify-center py-12">
                <div class="text-center">
                  <div class="w-16 h-16 border-4 border-purple-200 border-t-purple-600 rounded-full animate-spin mx-auto mb-4"></div>
                  <p class="text-gray-600 dark:text-gray-400">Áµ±Ë®à„ÇíË™≠„ÅøËæº„Åø‰∏≠...</p>
                </div>
              </div>
            </template>

            <template x-if="!loading">
              <div class="max-w-4xl mx-auto">
                <div class="mb-6">
                  <a href="#/" @click.prevent="navigate('')" class="inline-block px-4 py-2 text-gray-600 dark:text-gray-400 hover:text-purple-600 dark:hover:text-purple-400 mb-4">
                    ‚Üê „Éõ„Éº„É†„Å´Êàª„Çã
                  </a>
                  <h1 class="text-4xl font-bold text-gray-900 dark:text-gray-100 mb-2">üìä Áµ±Ë®à</h1>
                  <p class="text-gray-600 dark:text-gray-400">
                    Wiki„ÅÆÁµ±Ë®àÊÉÖÂ†±
                  </p>
                </div>

                <template x-if="!stats">
                  <div class="bg-white dark:bg-gray-800 rounded-lg shadow-lg p-8 text-center">
                    <p class="text-gray-600 dark:text-gray-400">Áµ±Ë®àÊÉÖÂ†±„ÇíÂèñÂæó„Åß„Åç„Åæ„Åõ„Çì„Åß„Åó„Åü</p>
                  </div>
                </template>

                <template x-if="stats">
                  <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                    <div class="bg-white dark:bg-gray-800 rounded-lg shadow-lg p-6">
                      <div class="flex items-center">
                        <div class="text-4xl mr-4">üìÑ</div>
                        <div>
                          <div class="text-sm text-gray-600 dark:text-gray-400">Á∑è„Éö„Éº„Ç∏Êï∞</div>
                          <div class="text-3xl font-bold text-gray-900 dark:text-gray-100" x-text="stats.totalPages"></div>
                        </div>
                      </div>
                    </div>

                    <div class="bg-white dark:bg-gray-800 rounded-lg shadow-lg p-6">
                      <div class="flex items-center">
                        <div class="text-4xl mr-4">üîó</div>
                        <div>
                          <div class="text-sm text-gray-600 dark:text-gray-400">Á∑è„É™„É≥„ÇØÊï∞</div>
                          <div class="text-3xl font-bold text-gray-900 dark:text-gray-100" x-text="stats.totalLinks || 0"></div>
                        </div>
                      </div>
                    </div>

                    <div class="bg-white dark:bg-gray-800 rounded-lg shadow-lg p-6">
                      <div class="flex items-center">
                        <div class="text-4xl mr-4">üè∑Ô∏è</div>
                        <div>
                          <div class="text-sm text-gray-600 dark:text-gray-400">Á∑è„Çø„Ç∞Êï∞</div>
                          <div class="text-3xl font-bold text-gray-900 dark:text-gray-100" x-text="stats.totalTags || 0"></div>
                        </div>
                      </div>
                    </div>

                    <div class="bg-white dark:bg-gray-800 rounded-lg shadow-lg p-6">
                      <div class="flex items-center">
                        <div class="text-4xl mr-4">üî¥</div>
                        <div>
                          <div class="text-sm text-gray-600 dark:text-gray-400">„É™„É≥„ÇØÂàá„Çå</div>
                          <div class="text-3xl font-bold text-red-600 dark:text-red-400" x-text="stats.brokenLinks || 0"></div>
                        </div>
                      </div>
                    </div>

                    <div class="bg-white dark:bg-gray-800 rounded-lg shadow-lg p-6">
                      <div class="flex items-center">
                        <div class="text-4xl mr-4">üèùÔ∏è</div>
                        <div>
                          <div class="text-sm text-gray-600 dark:text-gray-400">Â≠§Á´ã„Åó„Åü„Éö„Éº„Ç∏</div>
                          <div class="text-3xl font-bold text-yellow-600 dark:text-yellow-400" x-text="stats.orphanedPages || 0"></div>
                        </div>
                      </div>
                    </div>
                  </div>
                </template>
              </div>
            </template>
          </div>
        </template>

        <!-- Peer Management -->
        <template x-if="route === 'admin/peers'">
          <div x-data="peerManagement()">
            <template x-if="loading">
              <div class="flex items-center justify-center py-12">
                <div class="text-center">
                  <div class="w-16 h-16 border-4 border-purple-200 border-t-purple-600 rounded-full animate-spin mx-auto mb-4"></div>
                  <p class="text-gray-600 dark:text-gray-400">Loading peers...</p>
                </div>
              </div>
            </template>

            <template x-if="!loading">
              <div class="max-w-4xl mx-auto">
                <div class="mb-6">
                  <a href="#/" @click.prevent="navigate('')" class="inline-block px-4 py-2 text-gray-600 dark:text-gray-400 hover:text-purple-600 dark:hover:text-purple-400 mb-4">
                    ‚Üê „Éõ„Éº„É†„Å´Êàª„Çã
                  </a>
                  <div class="flex items-center justify-between">
                    <div>
                      <h1 class="text-4xl font-bold text-gray-900 dark:text-gray-100 mb-2">üîó ÈÄ£Âêà„Éî„Ç¢ÁÆ°ÁêÜ</h1>
                      <p class="text-gray-600 dark:text-gray-400">
                        ‰ø°È†º„Åô„Çã„Éî„Ç¢„Éé„Éº„Éâ„ÇíÁÆ°ÁêÜ„Åó„Åæ„Åô
                      </p>
                    </div>
                    <button @click="toggleAddForm()" class="px-4 py-2 bg-purple-600 text-white rounded-lg hover:bg-purple-700">
                      <span x-show="!showAddForm">‚ûï „Éî„Ç¢„ÇíËøΩÂä†</span>
                      <span x-show="showAddForm">„Ç≠„É£„É≥„Çª„É´</span>
                    </button>
                  </div>
                </div>

                <!-- Error -->
                <template x-if="error">
                  <div class="mb-4 p-4 bg-red-100 dark:bg-red-900/30 border border-red-300 dark:border-red-700 text-red-700 dark:text-red-300 rounded-lg">
                    <span x-text="error"></span>
                  </div>
                </template>

                <!-- Add Peer Form -->
                <div x-show="showAddForm" x-transition class="mb-6 bg-white dark:bg-gray-800 rounded-lg shadow-lg p-6">
                  <h2 class="text-xl font-bold text-gray-900 dark:text-gray-100 mb-4">Êñ∞„Åó„ÅÑ„Éî„Ç¢„ÇíËøΩÂä†</h2>
                  <div class="space-y-4">
                    <div>
                      <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2">„Éî„Ç¢Âêç</label>
                      <input
                        type="text"
                        x-model="newPeerName"
                        placeholder="‰æã: My Friend's Wiki"
                        class="w-full px-4 py-2 rounded-lg border border-gray-300 dark:border-gray-700 focus:border-purple-500 focus:ring-2 focus:ring-purple-200 dark:focus:ring-purple-800 outline-none bg-white dark:bg-gray-900 text-gray-900 dark:text-gray-100"
                      />
                    </div>
                    <div>
                      <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2">GAS Web App URL</label>
                      <input
                        type="url"
                        x-model="newPeerUrl"
                        placeholder="‰æã: https://script.google.com/macros/s/XXX/exec"
                        class="w-full px-4 py-2 rounded-lg border border-gray-300 dark:border-gray-700 focus:border-purple-500 focus:ring-2 focus:ring-purple-200 dark:focus:ring-purple-800 outline-none bg-white dark:bg-gray-900 text-gray-900 dark:text-gray-100"
                      />
                    </div>
                    <button
                      @click="addPeer()"
                      :disabled="loading"
                      class="w-full px-4 py-2 bg-purple-600 text-white rounded-lg hover:bg-purple-700 disabled:opacity-50 disabled:cursor-not-allowed"
                    >
                      <span x-text="loading ? 'ËøΩÂä†‰∏≠...' : 'ËøΩÂä†'"></span>
                    </button>
                  </div>
                </div>

                <!-- Peer List -->
                <template x-if="peers.length === 0">
                  <div class="bg-white dark:bg-gray-800 rounded-lg shadow-lg p-8 text-center">
                    <div class="text-6xl mb-4">üîó</div>
                    <h2 class="text-2xl font-bold text-gray-800 dark:text-gray-200 mb-2">
                      „Éî„Ç¢„ÅåÁôªÈå≤„Åï„Çå„Å¶„ÅÑ„Åæ„Åõ„Çì
                    </h2>
                    <p class="text-gray-600 dark:text-gray-400 mb-6">
                      ÈÄ£ÂêàÊ©üËÉΩ„Çí‰ΩøÁî®„Åô„Çã„Å´„ÅØ„ÄÅ‰ø°È†º„Åô„Çã„Éî„Ç¢„Éé„Éº„Éâ„ÇíËøΩÂä†„Åó„Å¶„Åè„Å†„Åï„ÅÑ„ÄÇ
                    </p>
                    <button @click="toggleAddForm()" class="px-6 py-3 bg-purple-600 text-white rounded-lg hover:bg-purple-700">
                      ÊúÄÂàù„ÅÆ„Éî„Ç¢„ÇíËøΩÂä†
                    </button>
                  </div>
                </template>

                <template x-if="peers.length > 0">
                  <div class="bg-white dark:bg-gray-800 rounded-lg shadow-lg overflow-hidden">
                    <div class="px-6 py-4 border-b border-gray-200 dark:border-gray-700">
                      <h2 class="text-lg font-semibold text-gray-900 dark:text-gray-100">
                        ÁôªÈå≤Ê∏à„Åø„Éî„Ç¢ (<span x-text="peers.length"></span>)
                      </h2>
                    </div>
                    <div class="divide-y divide-gray-200 dark:divide-gray-700">
                      <template x-for="peer in peers" :key="peer.id">
                        <div class="p-6 hover:bg-gray-50 dark:hover:bg-gray-700 transition-colors">
                          <div class="flex items-start justify-between">
                            <div class="flex-1">
                              <div class="flex items-center space-x-3 mb-2">
                                <h3 class="text-lg font-semibold text-gray-900 dark:text-gray-100" x-text="peer.name"></h3>
                                <span
                                  class="px-2 py-1 text-xs font-semibold rounded-full"
                                  :class="peer.isActive ? 'bg-green-100 dark:bg-green-900/30 text-green-700 dark:text-green-300' : 'bg-red-100 dark:bg-red-900/30 text-red-700 dark:text-red-300'"
                                  x-text="peer.isActive ? '„Ç¢„ÇØ„ÉÜ„Ç£„Éñ' : 'Èùû„Ç¢„ÇØ„ÉÜ„Ç£„Éñ'"
                                ></span>
                              </div>
                              <p class="text-sm text-gray-600 dark:text-gray-400 mb-2" x-text="peer.url"></p>
                              <p class="text-xs text-gray-500 dark:text-gray-500">
                                ÊúÄÁµÇÂêåÊúü: <span x-text="formatDate(peer.lastSyncedAt)"></span>
                              </p>
                            </div>
                            <button
                              @click="removePeer(peer.id)"
                              class="ml-4 px-3 py-1 text-sm text-red-600 dark:text-red-400 hover:bg-red-100 dark:hover:bg-red-900/30 rounded-lg transition-colors"
                            >
                              üóëÔ∏è ÂâäÈô§
                            </button>
                          </div>
                        </div>
                      </template>
                    </div>
                  </div>
                </template>

                <!-- Info Box -->
                <div class="mt-6 bg-blue-50 dark:bg-blue-900/20 border border-blue-200 dark:border-blue-800 rounded-lg p-4">
                  <h3 class="text-sm font-semibold text-blue-800 dark:text-blue-300 mb-2">üí° ÈÄ£ÂêàÊ©üËÉΩ„Å´„Å§„ÅÑ„Å¶</h3>
                  <p class="text-sm text-blue-700 dark:text-blue-400">
                    „Éî„Ç¢„Éé„Éº„Éâ„ÇíÁôªÈå≤„Åô„Çã„Å®„ÄÅ„Éö„Éº„Ç∏„ÅÆ‰ΩúÊàê„ÉªÊõ¥Êñ∞ÊôÇ„Å´Ëá™ÂãïÁöÑ„Å´ÊÉÖÂ†±„ÅåÂÖ±Êúâ„Åï„Çå„Åæ„Åô„ÄÇ
                    „Éî„Ç¢„Åã„ÇâÂèó‰ø°„Åó„Åü„Éö„Éº„Ç∏„ÅØ„Ç≠„É£„ÉÉ„Ç∑„É•„Å´‰øùÂ≠ò„Åï„Çå„ÄÅ„É≠„Éº„Ç´„É´„Éö„Éº„Ç∏„Å®ÂêåÊßò„Å´Èñ≤Ë¶ß„Åß„Åç„Åæ„Åô„ÄÇ
                  </p>
                </div>
              </div>
            </template>
          </div>
        </template>

        <!-- External Index Management -->
        <template x-if="route === 'admin/external-index'">
          <div x-data="externalIndexManagement()">
            <template x-if="loading">
              <div class="flex items-center justify-center py-12">
                <div class="text-center">
                  <div class="w-16 h-16 border-4 border-purple-200 border-t-purple-600 rounded-full animate-spin mx-auto mb-4"></div>
                  <p class="text-gray-600 dark:text-gray-400">Loading external wikis...</p>
                </div>
              </div>
            </template>

            <template x-if="!loading">
              <div class="max-w-4xl mx-auto">
                <div class="mb-6">
                  <a href="#/" @click.prevent="navigate('')" class="inline-block px-4 py-2 text-gray-600 dark:text-gray-400 hover:text-purple-600 dark:hover:text-purple-400 mb-4">
                    ‚Üê „Éõ„Éº„É†„Å´Êàª„Çã
                  </a>
                  <div class="flex items-center justify-between">
                    <div>
                      <h1 class="text-4xl font-bold text-gray-900 dark:text-gray-100 mb-2">üåê Â§ñÈÉ®Wiki„Ç§„É≥„Éá„ÉÉ„ÇØ„Çπ</h1>
                      <p class="text-gray-600 dark:text-gray-400">
                        Â§ñÈÉ®„ÅÆWiki„ÇíÁôªÈå≤„ÉªÁÆ°ÁêÜ„Åó„Åæ„Åô
                      </p>
                    </div>
                    <button @click="toggleAddForm()" class="px-4 py-2 bg-purple-600 text-white rounded-lg hover:bg-purple-700">
                      <span x-show="!showAddForm">‚ûï Wiki„ÇíËøΩÂä†</span>
                      <span x-show="showAddForm">„Ç≠„É£„É≥„Çª„É´</span>
                    </button>
                  </div>
                </div>

                <!-- Error -->
                <template x-if="error">
                  <div class="mb-4 p-4 bg-red-100 dark:bg-red-900/30 border border-red-300 dark:border-red-700 text-red-700 dark:text-red-300 rounded-lg">
                    <span x-text="error"></span>
                  </div>
                </template>

                <!-- Add External Wiki Form -->
                <div x-show="showAddForm" x-transition class="mb-6 bg-white dark:bg-gray-800 rounded-lg shadow-lg p-6">
                  <h2 class="text-xl font-bold text-gray-900 dark:text-gray-100 mb-4">Â§ñÈÉ®Wiki„ÇíËøΩÂä†</h2>
                  <div class="space-y-4">
                    <div>
                      <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2">Wiki ID</label>
                      <input
                        type="text"
                        x-model="newWikiId"
                        placeholder="‰æã: my-wiki"
                        class="w-full px-4 py-2 rounded-lg border border-gray-300 dark:border-gray-700 focus:border-purple-500 focus:ring-2 focus:ring-purple-200 dark:focus:ring-purple-800 outline-none bg-white dark:bg-gray-900 text-gray-900 dark:text-gray-100"
                      />
                    </div>
                    <div>
                      <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2">Wiki„Çø„Ç§„Éà„É´</label>
                      <input
                        type="text"
                        x-model="newTitle"
                        placeholder="‰æã: My Friend's Wiki"
                        class="w-full px-4 py-2 rounded-lg border border-gray-300 dark:border-gray-700 focus:border-purple-500 focus:ring-2 focus:ring-purple-200 dark:focus:ring-purple-800 outline-none bg-white dark:bg-gray-900 text-gray-900 dark:text-gray-100"
                      />
                    </div>
                    <div>
                      <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2">Ë™¨Êòé</label>
                      <textarea
                        x-model="newDescription"
                        placeholder="„Åì„ÅÆWiki„Å´„Å§„ÅÑ„Å¶„ÅÆË™¨Êòé..."
                        rows="3"
                        class="w-full px-4 py-2 rounded-lg border border-gray-300 dark:border-gray-700 focus:border-purple-500 focus:ring-2 focus:ring-purple-200 dark:focus:ring-purple-800 outline-none bg-white dark:bg-gray-900 text-gray-900 dark:text-gray-100"
                      ></textarea>
                    </div>
                    <div>
                      <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2">„Ç¢„ÇØ„Çª„ÇπURL</label>
                      <input
                        type="url"
                        x-model="newAccessUrl"
                        placeholder="‰æã: https://script.google.com/macros/s/XXX/exec"
                        class="w-full px-4 py-2 rounded-lg border border-gray-300 dark:border-gray-700 focus:border-purple-500 focus:ring-2 focus:ring-purple-200 dark:focus:ring-purple-800 outline-none bg-white dark:bg-gray-900 text-gray-900 dark:text-gray-100"
                      />
                    </div>
                    <div>
                      <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2">„Çø„Ç∞Ôºà„Ç´„É≥„ÉûÂå∫Âàá„ÇäÔºâ</label>
                      <input
                        type="text"
                        x-model="newTags"
                        placeholder="‰æã: tech, programming, friends"
                        class="w-full px-4 py-2 rounded-lg border border-gray-300 dark:border-gray-700 focus:border-purple-500 focus:ring-2 focus:ring-purple-200 dark:focus:ring-purple-800 outline-none bg-white dark:bg-gray-900 text-gray-900 dark:text-gray-100"
                      />
                    </div>
                    <button
                      @click="addExternalWiki()"
                      :disabled="loading"
                      class="w-full px-4 py-2 bg-purple-600 text-white rounded-lg hover:bg-purple-700 disabled:opacity-50 disabled:cursor-not-allowed"
                    >
                      <span x-text="loading ? 'ËøΩÂä†‰∏≠...' : 'ËøΩÂä†'"></span>
                    </button>
                  </div>
                </div>

                <!-- External Wiki List -->
                <template x-if="externalWikis.length === 0">
                  <div class="bg-white dark:bg-gray-800 rounded-lg shadow-lg p-8 text-center">
                    <div class="text-6xl mb-4">üåê</div>
                    <h2 class="text-2xl font-bold text-gray-800 dark:text-gray-200 mb-2">
                      Â§ñÈÉ®Wiki„ÅåÁôªÈå≤„Åï„Çå„Å¶„ÅÑ„Åæ„Åõ„Çì
                    </h2>
                    <p class="text-gray-600 dark:text-gray-400 mb-6">
                      Â§ñÈÉ®Wiki„Çí„Ç§„É≥„Éá„ÉÉ„ÇØ„Çπ„Å´ÁôªÈå≤„Åó„Å¶„ÄÅÈÄ£Âêà„Éç„ÉÉ„Éà„ÉØ„Éº„ÇØ„ÇíÊã°Âºµ„Åó„Åæ„Åó„Çá„ÅÜ„ÄÇ
                    </p>
                    <button @click="toggleAddForm()" class="px-6 py-3 bg-purple-600 text-white rounded-lg hover:bg-purple-700">
                      ÊúÄÂàù„ÅÆWiki„ÇíËøΩÂä†
                    </button>
                  </div>
                </template>

                <template x-if="externalWikis.length > 0">
                  <div class="bg-white dark:bg-gray-800 rounded-lg shadow-lg overflow-hidden">
                    <div class="px-6 py-4 border-b border-gray-200 dark:border-gray-700">
                      <h2 class="text-lg font-semibold text-gray-900 dark:text-gray-100">
                        ÁôªÈå≤Ê∏à„ÅøÂ§ñÈÉ®Wiki (<span x-text="externalWikis.length"></span>)
                      </h2>
                    </div>
                    <div class="divide-y divide-gray-200 dark:divide-gray-700">
                      <template x-for="wiki in externalWikis" :key="wiki.wikiId">
                        <div class="p-6 hover:bg-gray-50 dark:hover:bg-gray-700 transition-colors">
                          <div class="flex items-start justify-between">
                            <div class="flex-1">
                              <h3 class="text-lg font-semibold text-gray-900 dark:text-gray-100 mb-1" x-text="wiki.title"></h3>
                              <p class="text-sm text-gray-600 dark:text-gray-400 mb-2" x-text="wiki.description || 'Ë™¨Êòé„Å™„Åó'"></p>
                              <div class="flex items-center space-x-4 mb-2">
                                <span class="text-xs text-gray-500 dark:text-gray-500">
                                  Wiki ID: <span class="font-mono" x-text="wiki.wikiId"></span>
                                </span>
                                <span class="text-xs text-gray-500 dark:text-gray-500">
                                  ÁôªÈå≤Êó•: <span x-text="formatDate(wiki.registeredAt)"></span>
                                </span>
                              </div>
                              <p class="text-xs text-gray-500 dark:text-gray-500 mb-2" x-text="wiki.accessUrl"></p>
                              <template x-if="wiki.tags">
                                <div class="flex flex-wrap gap-1">
                                  <template x-for="tag in wiki.tags.split(',').map(t => t.trim()).filter(Boolean)" :key="tag">
                                    <span class="px-2 py-1 text-xs bg-purple-100 dark:bg-purple-900/30 text-purple-700 dark:text-purple-300 rounded-full" x-text="tag"></span>
                                  </template>
                                </div>
                              </template>
                            </div>
                            <button
                              @click="removeExternalWiki(wiki.accessUrl)"
                              class="ml-4 px-3 py-1 text-sm text-red-600 dark:text-red-400 hover:bg-red-100 dark:hover:bg-red-900/30 rounded-lg transition-colors"
                            >
                              üóëÔ∏è ÂâäÈô§
                            </button>
                          </div>
                        </div>
                      </template>
                    </div>
                  </div>
                </template>

                <!-- Info Box -->
                <div class="mt-6 bg-blue-50 dark:bg-blue-900/20 border border-blue-200 dark:border-blue-800 rounded-lg p-4">
                  <h3 class="text-sm font-semibold text-blue-800 dark:text-blue-300 mb-2">üí° Â§ñÈÉ®Wiki„Ç§„É≥„Éá„ÉÉ„ÇØ„Çπ„Å´„Å§„ÅÑ„Å¶</h3>
                  <p class="text-sm text-blue-700 dark:text-blue-400">
                    Â§ñÈÉ®Wiki„Çí„Ç§„É≥„Éá„ÉÉ„ÇØ„Çπ„Å´ÁôªÈå≤„Åô„Çã„Å®„ÄÅ„Åù„ÅÆWiki„ÅÆÂ≠òÂú®„Çí‰ªñ„ÅÆ„Éé„Éº„Éâ„Å´‰ºù„Åà„Çã„Åì„Å®„Åå„Åß„Åç„Åæ„Åô„ÄÇ
                    „Ç§„É≥„Éá„ÉÉ„ÇØ„Çπ„ÅØÂàÜÊï£Âûã„ÅÆWiki„Éá„Ç£„É¨„ÇØ„Éà„É™„Å®„Åó„Å¶Ê©üËÉΩ„Åó„ÄÅ„Éç„ÉÉ„Éà„ÉØ„Éº„ÇØÂÜÖ„ÅÆWiki„ÅÆÁô∫Ë¶ã„ÇíÂÆπÊòì„Å´„Åó„Åæ„Åô„ÄÇ
                  </p>
                </div>
              </div>
            </template>
          </div>
        </template>

        <!-- 404 -->
        <template x-if="route && route !== '' && route !== 'new' && !route.startsWith('page/') && !route.startsWith('edit/') && !route.startsWith('admin/')">
          <div class="text-center py-12">
            <h1 class="text-4xl font-bold text-gray-900 dark:text-gray-100 mb-4">404</h1>
            <p class="text-gray-600 dark:text-gray-400">Page not found</p>
            <a href="#/" @click.prevent="navigate('')" class="mt-4 inline-block text-purple-600 hover:text-purple-700">Go home</a>
          </div>
        </template>
      </main>
    </div>

    <script type="module" src="/src/main.ts"></script>
  </body>
</html>
